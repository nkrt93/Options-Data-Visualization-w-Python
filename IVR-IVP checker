import yfinance as yf

# Prompt user for ticker symbol
ticker = input("Enter ticker symbol: ")

# Get options data for the ticker
options = yf.Ticker(ticker).options

# Convert options to a DataFrame
options_df = yf.Ticker(ticker).option_chain(options[0]).calls

# Get the most recent implied volatility
implied_volatility = options_df.iloc[-1]["impliedVolatility"]

# Get historical data for the ticker
historical_data = yf.Ticker(ticker).history(period="1y")

# Calculate IV rank
iv_rank = (historical_data["Close"].iloc[-1] - historical_data["Close"].min()) / (historical_data["Close"].max() - historical_data["Close"].min())

# Calculate IV percentile
iv_percentile = (historical_data["Close"].iloc[-1] - historical_data["Close"].min()) / (historical_data["Close"].quantile(0.75) - historical_data["Close"].quantile(0.25))

# Get 52-week high and low
high_52_weeks = historical_data["Close"].max()
low_52_weeks = historical_data["Close"].min()

# Print results
print("Ticker Symbol: ", ticker)
print("IV Rank: {:.2%}".format(iv_rank))
print("IV Percentile: {:.2%}".format(iv_percentile))
print("52-Week High: ${:.2f}".format(high_52_weeks))
print("52-Week Low: ${:.2f}".format(low_52_weeks))
